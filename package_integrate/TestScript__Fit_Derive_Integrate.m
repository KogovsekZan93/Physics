clc;pause('on');pause('off');clear all;

xData = [0; 1; 3; 5; 8; 35; 37; 40; 45];
yData = [10; 9; 8; 11; 13; 5; 4; 3; 2];

LimitsWithinBounds = [3.5; 36];
LimitsOutOfBoundsRight = [3; 51];
LimitsOutOfBoundsLeft = [-2; 37];

accuracyLow = 0;
accuracyMedium = 2;
accuracyHigh = 4;

mode0 = 0;
mode1 = 1;
mode2 = 2;

figr1 = 1;
figr4 = 4;
figr22 = 22;


% ZDefiniteIntegralA

DefiniteIntegralA = ZDefiniteIntegralA(xData, yData, LimitsWithinBounds);
if abs(DefiniteIntegralA - 299) > power(10, -12)
    fprintf('There is a problem with DefiniteIntegralA: \nDefiniteIntegralA = ZDefiniteIntegralA(xData, yData, LimitsWithinBounds)\n');
end
clear DefiniteIntegralA;

DefiniteIntegralA = ZDefiniteIntegralA(xData, yData, LimitsOutOfBoundsRight, 'PseudoAccuracy', accuracyMedium);
if abs(DefiniteIntegralA - 4.026682382574147e+02) > power(10, -12)
    fprintf('There is a problem with DefiniteIntegralA: \nDefiniteIntegralA = ZDefiniteIntegralA(xData, yData, LimitsOutOfBoundsRight, ''PseudoAccuracy'', accuracyMedium)\n');
end
clear DefiniteIntegralA ;

DefiniteIntegralA = ZDefiniteIntegralA(xData, yData, LimitsOutOfBoundsLeft, 'PseudoAccuracy', accuracyHigh, 'Mode', mode0, 'Figure', figr1);
if abs(DefiniteIntegralA - (-1.707300734025471e+03)) > power(10, -12)
    fprintf('There is a problem with DefiniteIntegralA: \nDefiniteIntegralA = ZDefiniteIntegralA(xData, yData, LimitsOutOfBoundsLeft, ''PseudoAccuracy'', accuracyHigh, ''Mode'', mode0, ''Figure'', figr1)\n');
end
clear DefiniteIntegralA;
close(figr1);


% ZDerivariveA

xDerivativeInBounds = (linspace(5, 37.5, 100))';
xDerivativeOutOfBoundsRight = (linspace(3.5, 46, 100))';
xDerivativeOutOfBoundsLeft = (linspace(-1, 45, 100))';
xDerivativeOutOfBounds = (linspace(-2, 47, 100))';

ordDeriv2 = 2;
ordDeriv4 = 4;

yDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBounds);
yDerivativeAStandard =  [-1.833333333333333; -1.668350168350168; -1.503367003367003; -1.338383838383838; -1.173400673400673; -1.008417508417508; -0.843434343434343; -0.678451178451178; -0.513468013468014; -0.348484848484849; 0.449494949494949;  0.944444444444445; 1.439393939393939; 1.934343434343434; 1.190235690235690; 1.025252525252525; 0.860269360269360; 0.695286195286196; 0.530303030303030; 0.365319865319865; 0.200336700336700;  0.545080433969323; 0.513305898491083; 0.481531363012844; 0.449756827534605;  0.417982292056366; 0.386207756578127;  0.354433221099888; 0.322658685621648; 0.290884150143409;  0.259109614665170; 0.227335079186931; 0.195560543708692;  0.163786008230453;  0.132011472752213; 0.100236937273974; 0.068462401795735; 0.036687866317496; 0.004913330839257; -0.026861204638983; -0.058635740117222; -0.090410275595461; -0.122184811073700; -0.153959346551939; -0.185733882030178; -0.217508417508418; -0.249282952986657; -0.292961543919398; -0.299914857386122; -0.306868170852845; -0.313821484319569; -0.320774797786292; -0.327728111253015; -0.334681424719739; -0.341634738186462; -0.348588051653186; -0.355541365119909; -0.362494678586633; -0.369447992053356; -0.376401305520079; -0.383354618986803; -0.390307932453526; -0.397261245920250; -0.404214559386973; -0.411167872853697; -0.418121186320420; -0.425074499787144; -0.432027813253867; -0.438981126720590; -0.445934440187314; -0.452887753654037; -0.459841067120761; -0.466794380587484; -0.473747694054208; -0.480701007520931; -0.558585858585857; -0.525589225589224; -0.492592592592592; -0.459595959595959; -0.426599326599326; -0.393602693602694; -0.360606060606060; -0.327609427609428; -0.294612794612795; -0.261616161616162; -0.280976430976431; -0.264478114478114; -0.247979797979798; -0.231481481481481; -0.214983164983164; -0.198484848484848; -0.181986531986531; -0.165488215488214; -0.148989898989897; -0.132491582491581; -0.115993265993264; -0.099494949494948; -0.082996632996631; -0.066498316498314; -0.049999999999998];
if sum(abs(yDerivativeAStandard-yDerivativeA)) > power(10, -12)
    fprintf('There is a problem with ZDerivativeA: \nyDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBounds\n');
end
clear yDerivativeA yDerivativeAStandard;

yDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBoundsRight, 'Accuracy', accuracyHigh, 'Mode', mode2, 'Figure', figr4);
yDerivativeAStandard = [1.051488095238096; 1.506395313884345; 1.884700178513947; 2.147975193360868; 1.612057738188002; 1.432489143403610; 1.165675906256149; 0.817171558288826; 0.392529631044849; -0.102696343932570; -0.662952835100229; 0.221273523347939; 0.131204722240096; 0.047610212226123; -0.029701093851490; -0.100920283150246; -0.166238442827654; -0.225846660041219; -0.279936021948450; -0.328697615706851; -0.372322528473931; -0.411001847407196; -0.444926659664152; -0.474288052402307; -0.499277112779167; -0.520084927952238; -0.536902585079028; -0.549921171317044; -0.559331773823792; -0.565325479756780; -0.568093376273512; -0.567826550531496; -0.564716089688240; -0.558953080901250; -0.550728611328031; -0.540233768126092; -0.527659638452940; -0.513197309466079; -0.497037868323019; -0.479372402181264; -0.460391998198324; -0.440287743531702; -0.443112156566217; -0.464194304246192; -0.484367179331610; -0.503604871915288; -0.521881472090045; -0.539171069948698; -0.555447755584066; -0.570685619088967; -0.584858750556217; -0.597941240078637; -0.609907177749042; -0.620730653660251; -0.630385757905084; -0.638846580576356; -0.646087211766886; -0.652081741569492; -0.656804260076993; -0.660228857382205; -0.662329623577947; -0.663080648757038; -0.662456023012294; -0.660429836436534; -0.656976179122576; -0.652069141163238; -0.645682812651337; -0.637791283679692; -0.628368644341121; -0.617388984728441; -0.604826394934471; -0.590654965052029; -0.574848785173932; -0.557381945392998; -0.554793542876631; -0.522092865758060; -0.489991562170877;  -0.458639883438602; -0.428188080884778; -0.398786405832926; -0.370585109606575; -0.343734443529248; -0.318384658924476; -0.294686007115786; -0.272788739426707; -0.252843107180771; -0.234999361701494; -0.219407754312414; -0.206218536337055; -0.195581959098943; -0.187648273921605; -0.182567732128568; -0.180490585043371; -0.181567083989526; -0.185947480290571; -0.193782025270032; -0.205220970251432; -0.220414566558306; -0.239513065514176; -0.262666718442572];
if sum(abs(yDerivativeAStandard - yDerivativeA)) > power(10, -12)
    fprintf('There is a problem with ZDerivativeA: \nyDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBoundsRight, ''Accuracy'', accuracyHigh, ''Mode'', mode2, ''Figure'', figr4)\n');
end
clear yDerivativeA yDerivativeAStandard;
close(figr4);

yDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBoundsLeft, 'OrdDeriv', ordDeriv4, 'Accuracy', accuracyMedium);
yDerivativeAStandard = [-0.835143168378461; -0.798242964974990; -0.761342761571518; -0.724442558168047; -0.687542354764576; -0.650642151361104; -0.613741947957633; -0.576841744554162; -0.539941541150690; -0.503041337747219; -0.466141134343748; -0.429240930940277; -0.392340727536805; -0.355440524133334; -0.318540320729863; -0.281640117326391; -0.244739913922920; -0.207839710519449; -0.170939507115977; -0.134039303712506; -0.097139100309035; -0.060238896905563; -0.023338693502092; 0.013561509901379; 0.050461713304851; 0.087361916708322; 0.124262120111793; 0.161162323515264; 0.198062526918736; 0.234962730322207; 0.271862933725678; 0.308763137129150; 0.345663340532621; 0.382563543936092; 0.419463747339564; 0.456363950743035; 0.493264154146506; 0.530164357549977; 0.567064560953449; 0.603964764356920; 0.640864967760391; 0.677765171163863; -0.011644420191158; -0.016330289178638; -0.021016158166118; -0.025702027153599; -0.030387896141079; -0.001214997139045; -0.001042777144873; -0.000870557150701; -0.000698337156530; -0.000526117162358; -0.000353897168186; -0.000181677174014; 0.000580521744315; 0.000451196955029; 0.000321872165742; 0.000192547376455; 0.000063222587169; -0.000066102202118; -0.000195426991404; -0.000324751780691; -0.000454076569977; -0.000583401359264; -0.000712726148550; -0.000842050937837; -0.000971375727123; -0.001100700516410; -0.001230025305696; -0.001359350094983; -0.001488674884269; -0.001617999673556; -0.001747324462842; -0.001876649252129; -0.002005974041415; -0.002135298830702; -0.002264623619988; -0.002393948409275; -0.002523273198561; -0.002652597987848; -0.002781922777134; -0.002911247566421; -0.003040572355707; -0.003169897144994; -0.003299221934280; -0.003428546723567; -0.003557871512853; -0.003687196302140; -0.003816521091426; -0.003945845880713; -0.004075170669999; -0.004204495459286; -0.004333820248572; -0.004463145037859; -0.004592469827146; -0.004721794616432; -0.004851119405719; -0.004980444195005; -0.005109768984292; -0.005239093773578];
if sum(abs(yDerivativeAStandard - yDerivativeA)) > power(10, -12)
    fprintf('There is a problem with ZDerivativeA: \nyDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBoundsLeft, ''OrdDeriv'', ordDeriv4, ''Accuracy'', accuracyMedium)\n');
end
clear yDerivativeA;

yDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBoundsLeft, 'OrdDeriv', ordDeriv2, 'Mode', mode0);
yDerivativeAStandard = [-0.600000000000004; -0.414141414141417; -0.228282828282831; -0.042424242424245; 0.143434343434342; 0.329292929292928; 0.515151515151515; 0.701010101010101; 0.886868686868687; 1.072727272727274; 1.258585858585860;  0.365079365079365;  0.099567099567099; -0.165945165945166; -0.431457431457432; -0.696969696969698; -0.962481962481963; -1.227994227994229; -1.493506493506494; -1.759018759018760; -2.024531024531025; -2.290043290043291; -2.555555555555557; -2.821067821067822; -3.086580086580088; -3.352092352092354; -3.617604617604619; -3.883116883116884; -4.148629148629151; -4.414141414141415; -4.679653679653681; -4.945165945165948; -5.210678210678212; -5.476190476190478; -5.741702741702744; -6.007215007215009; -6.272727272727275; -6.538239538239539; -6.803751803751807; -7.069264069264072; -7.334776334776336; -0.012460250654695; -0.000736531986532; 0.010987186681631; 0.022710905349794; 0.034434624017957; -0.043634541455423; -0.041450020640634; -0.039265499825845; -0.037080979011056; -0.034896458196267; -0.044087425983977; -0.040571423042687; -0.037055420101397; -0.033539417160106; -0.030023414218816; -0.026507411277526; -0.022991408336236; -0.019475405394945; -0.015959402453655; 0.171212121212159; 0.166565656565693; 0.161919191919227; 0.157272727272761; 0.152626262626295; 0.147979797979829; 0.143333333333363; 0.138686868686897; 0.134040404040431; 0.129393939393965; 0.124747474747499; 0.120101010101033; 0.115454545454567; 0.110808080808101; 0.106161616161635; 0.101515151515169; 0.096868686868703; 0.092222222222237; 0.087575757575771; 0.082929292929305; 0.078282828282839; 0.073636363636373; 0.068989898989907; 0.064343434343441; 0.059696969696975; 0.055050505050509; 0.050404040404043; 0.045757575757577; 0.041111111111111; 0.036464646464645; 0.031818181818179; 0.027171717171713; 0.022525252525247; 0.017878787878780; 0.013232323232314; 0.008585858585848;  0.003939393939382; -0.000707070707084; -0.005353535353550; -0.010000000000016];
if sum(abs(yDerivativeAStandard - yDerivativeA)) > power(10, -12)
    fprintf('There is a problem with ZDerivativeA: \nyDerivativeA = ZDerivativeA(xData, yData, xDerivativeOutOfBoundsLeft, ''OrdDeriv'', ordDeriv2, ''Mode'', mode0)\n');
end
clear yDerivativeA yDerivativeAStandard;


% ZDerivativeSpline

yDerivativeSpline = ZDerivativeSpline(xData, yData, xDerivativeOutOfBounds, 'Figure', figr22);
yDerivativeSplineStandard = [2.371597130816784; 1.293539791379494;  0.414857197332064; -0.264450651325504; -0.744383754593213; -1.024942112471062; -1.106125724959051; -0.987934592057179; -0.670368713765448;-0.153428090083857; 0.562887278987595; 1.274203314836390; 1.680609502308522; 1.779466713322735; 1.570774947879028; 1.190456471927324; 0.868824013882766; 0.609653192243966; 0.412944007010922; 0.278696458183635; 0.206910545762105; 0.177969458690158; 0.150846848532763; 0.124252984122518; 0.098187865459423; 0.072651492543478; 0.047643865374684; 0.023164983953039; -0.000785151721455; -0.024206541648800; -0.047099185828994; -0.069463084262038; -0.091298236947933; -0.112604643886676; -0.133382305078270; -0.153631220522714; -0.173351390220008; -0.192542814170152; -0.211205492373145; -0.229339424828989; -0.246944611537682; -0.264021052499225; -0.280568747713619; -0.296587697180862; -0.312077900900955; -0.327039358873898; -0.341472071099690; -0.355376037578333; -0.368751258309826; -0.381597733294168; -0.393915462531361; -0.405704446021403; -0.416964683764295; -0.427696175760037; -0.437898922008630; -0.447572922510072; -0.456718177264363; -0.465334686271505; -0.473422449531497; -0.480981467044338; -0.488011738810030; -0.494513264828571; -0.500486045099963; -0.505930079624204; -0.510845368401295; -0.515231911431236; -0.519089708714027; -0.522418760249668; -0.525219066038158; -0.527490626079499; -0.529233440373689; -0.530447508920730; -0.531132831720620; -0.531289408773361; -0.530917240078951; -0.529721513519057; -0.520968638418674; -0.501855852347251; -0.472383155304788; -0.432840500322553; -0.392451293325164; -0.355625719918200; -0.322363780101661; -0.292665473875547; -0.266530801239857; -0.243959762194593; -0.224952356739752; -0.209508584875337; -0.197628446601347; -0.189311941917781; -0.184559070824640; -0.183369833321924; -0.185744229409632; -0.191682259087766; -0.201183922356324; -0.214249219215307; -0.230878149664715; -0.251070713704547; -0.274826911334804; -0.302146742555486];
if sum(abs(yDerivativeSplineStandard - yDerivativeSpline)) > power(10, -12)
    fprintf('There is a problem with ZDerivativeSpline: \nyDerivativeSpline = ZDerivativeSpline(xData, yData, xDerivativeOutOfBounds, ''Figure'', figr22)\n');
end
clear yDerivativeSpline yDerivativeSplineStandard;
close(figr22)

[yDerivativeSpline, ppDerivativeSpline] = ZDerivativeSpline(xData, yData, xDerivativeInBounds, 'OrdDeriv', ordDeriv2);
yDerivativeSplineStandard = [-0.821097558205516; -0.737394803047032; -0.653692047888547; -0.569989292730062; -0.486286537571577; -0.402583782413092; -0.318881027254608; -0.235178272096123; -0.151475516937638; -0.067772761779153; -0.055572702541392; -0.054864148005176; -0.054155593468959; -0.053447038932743; -0.052738484396527; -0.052029929860310; -0.051321375324094; -0.050612820787878; -0.049904266251661; -0.049195711715445; -0.048487157179229; -0.047778602643012; -0.047070048106796; -0.046361493570580; -0.045652939034363; -0.044944384498147; -0.044235829961931; -0.043527275425714; -0.042818720889498; -0.042110166353282; -0.041401611817065;  -0.040693057280849; -0.039984502744633; -0.039275948208416; -0.038567393672200; -0.037858839135984; -0.037150284599767; -0.036441730063551; -0.035733175527335; -0.035024620991118; -0.034316066454902; -0.033607511918686; -0.032898957382469; -0.032190402846253; -0.031481848310037; -0.030773293773820; -0.030064739237604; -0.029356184701388; -0.028647630165171; -0.027939075628955; -0.027230521092739; -0.026521966556522; -0.025813412020306; -0.025104857484090; -0.024396302947873; -0.023687748411657; -0.022979193875441; -0.022270639339224; -0.021562084803008; -0.020853530266792; -0.020144975730575; -0.019436421194359; -0.018727866658143; -0.018019312121926; -0.017310757585710; -0.016602203049494; -0.015893648513277; -0.015185093977061; -0.014476539440845; -0.013767984904628; -0.013059430368412; -0.012350875832195; -0.011642321295979; -0.010933766759763; -0.010225212223546; -0.009516657687330; -0.008808103151114; -0.008099548614897; -0.007390994078681; -0.006682439542465; -0.005973885006248; -0.005265330470032; -0.004556775933816; -0.003848221397599; -0.003139666861383; -0.002431112325167; -0.001722557788950; -0.001014003252734; -0.000305448716518; 0.000403105819699; 0.001111660355915; 0.001820214892131; 0.010636102682534; 0.024519073756803; 0.038402044831073; 0.052285015905342; 0.066167986979611; 0.080050958053881; 0.084174110095687; 0.079398603607893];
if abs(ppval(ppDerivativeSpline, 7) - (-0.311154619086132)) > power(10, -14) || sum(abs(yDerivativeSplineStandard - yDerivativeSpline)) > power(10, -12)
    fprintf('There is a problem with ZDerivativeSpline: \n[yDerivativeSpline, ppDerivativeSpline] = ZDerivativeSpline(xData, yData, xDerivativeInBounds, ''OrdDeriv'', ordDeriv2)\n');
end
clear yDerivativeSpline yDerivativeSplineStandard ppDerivativeSpline;


% ZFitA

% figure(1);plot(xDerivativeAOutOfBoundsRight, yDerivativeA, 'r', 'LineWidth', 1);grid on;